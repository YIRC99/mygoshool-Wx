(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["subpkg/updateCarOrder"],{"1f03":function(e,t,n){},"25a4":function(e,t,n){"use strict";var r=n("1f03"),o=n.n(r);o.a},"696d":function(e,t,n){"use strict";n.r(t);var r=n("831d"),o=n.n(r);for(var i in r)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return r[e]}))}(i);t["default"]=o.a},"831d":function(e,t,n){"use strict";(function(e){var r=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n("2eee")),i=r(n("9523")),s=r(n("c973")),c=r(n("2ee6"));function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){(0,i.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(){var e=new Date,t=e.getFullYear(),n=new Date(t,11,31,23,59,59,999);return n.getTime()}var d={mixins:[c.default],data:function(){return{endDate:l(),isUploadWximg:!0,isLoading:!1,isPageLoding:!0,fileList1:[],columns:[["1","2","3"]],StartTimeValue:Number(new Date),MinStartTimeValue:Number(new Date),wechatError:!1,phoneError:!1,phoneErrorMessage:"手机号不能为空或格式不正确",wechatErrorMsg:"",currentOrder:{startaddress:"",startaddressall:"",startdatetime:"",endaddress:"",endaddressall:"",currentperson:"",lackperson:"",wechataccount:"",isafter:"",isbefore:"",beforetime:"",aftertime:"",remark:""},afterAdd:!0}},computed:{isValid:function(){return""!==this.currentOrder.wechataccount},isTips:function(){return""==this.currentOrder.wechataccount.trim()&&!this.isUploadWximg}},filters:{},watch:{"currentOrder.wechataccount":{handler:function(e,t){var n=/[\u4e00-\u9fa5]/i.test(e);n?(this.wechatError=!0,this.wechatErrorMsg="微信号不能包含中文字符"):(this.wechatError=!1,this.wechatErrorMsg="")},deep:!0}},onLoad:function(t){var n=this;this.post({url:"carshareorder/getbyorderid",data:{orderid:e.getStorageSync("updateCarOrderId")}}).then((function(e){n.isPageLoding=!1,200===e.code?(n.currentOrder=e.data,n.fileList1.push({message:"",size:"",status:"success",thumb:n.QRttp+n.currentOrder.wechatImg,type:"image",url:"200"}),console.log("this.currentOrder",n.currentOrder)):n.$refs.message.show({type:"error",msg:"查询订单失败, 请稍候重试吧"})}))},methods:{updateOrder:function(){var t=this,n=this.isWrite();console.log("isWriteResult",n),n&&this.afterAdd&&(this.afterAdd=!1,console.log(this.currentOrder),this.isLoading=!0,this.post({url:"carshareorder/update",data:this.currentOrder}).then((function(n){if(t.isLoading=!1,200!==n.code)return t.afterAdd=!0,void t.$refs.message.show({type:"error",msg:"修改订单失败, 请稍候重试吧"});t.$refs.message.show({type:"success",msg:"修改成功"}),setTimeout((function(){e.navigateBack()}),1e3)})).catch((function(e){t.afterAdd=!0,t.isLoading=!1,t.$refs.message.show({type:"error",msg:"网络开了点小差,请稍候重试吧"})})))},clickUploadImgM:function(){this.fileList1.length>=1||this.$refs.uploadWxImgRef.chooseFile()},uploadFilePromise:function(t){var n=this;return new Promise((function(r,o){e.uploadFile({url:n.http+"common/upload?path=QRcode",filePath:t,name:"file",formData:{user:"test"},timeout:5e3,success:function(e){console.log("上传成功",e.statusCode),n.isUploadWximg=!0;var t=JSON.parse(e.data).data;n.currentOrder.wechatImg=t,r(200)},fail:function(e){console.log("上传失败",e),r(400)}})}))},overSize:function(){this.$refs.message.show({type:"error",msg:"图片超过3MB大小"})},afterRead:function(t){var n=this;return(0,s.default)(o.default.mark((function r(){var i,c,a,l;return o.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:for(i=[].concat(t.file),c=n["fileList".concat(t.name)].length,i.map((function(e){n["fileList".concat(t.name)].push(u(u({},e),{},{status:"uploading",message:"上传中"}))})),console.log(n.fileList1),a=function(r){console.log("还没有调用上传方法",i),e.compressImage({src:i[r].url,quality:70,success:function(){var e=(0,s.default)(o.default.mark((function e(s){var a,u;return o.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log(s.tempFilePath),console.log("压缩完成了"),i[r].url=s.tempFilePath,e.next=5,n.uploadFilePromise(i[r].url);case 5:a=e.sent,u=n["fileList".concat(t.name)][c],400==a?n["fileList".concat(t.name)].splice(c,1,Object.assign(u,{status:"failed",message:"请重新上传",url:a})):n["fileList".concat(t.name)].splice(c,1,Object.assign(u,{status:"success",message:"",url:a})),c++;case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()})},l=0;l<i.length;l++)a(l);case 6:case"end":return r.stop()}}),r)})))()},deletePic:function(e){this["fileList".concat(e.name)].splice(e.index,1),this.isUploadWximg=!1},isWrite:function(){return 1==this.currentOrder.isafter&&"00:00"==this.currentOrder.aftertime?(this.$refs.message.show({type:"warning",msg:"请选择能接受的延后时间范围"}),!1):1==this.currentOrder.isbefore&&"00:00"==this.currentOrder.beforetime?(this.$refs.message.show({type:"warning",msg:"请选择能接受的提前时间范围"}),!1):!(""==this.currentOrder.wechataccount.trim()&&!this.isUploadWximg)||(this.$refs.message.show({type:"warning",msg:"请输入联系方式"}),!1)},formatter:function(e,t){return"year"===e?"".concat(t,"年"):"month"===e?"".concat(t,"月"):"day"===e?"".concat(t,"日"):"hour"===e?"".concat(t,"时"):"minute"===e?"".concat(t,"分"):t},choseEndAddress:function(){var t=this;e.chooseLocation({success:function(e){t.currentOrder.endaddress=e.name,t.currentOrder.endaddressall=e.address+e.name},fail:function(){e.getSetting({success:function(t){console.log(t);var n=t.authSetting;n["scope.userLocation"]||e.showModal({title:"是否授权当前位置",content:"需要获取您的地理位置，请确认授权，否则地图功能将无法使用",success:function(t){t.confirm&&e.openSetting({success:function(t){!0===t.authSetting["scope.userLocation"]?(e.showToast({title:"授权成功",icon:"success",duration:1e3}),e.chooseLocation({success:function(e){console.log("详细地址",e)}})):e.showToast({title:"授权失败",icon:"none",duration:1e3})}})}})},fail:function(t){e.showToast({title:"调用授权窗口失败",icon:"none",duration:1e3})}})}})},choseStartAddress:function(){var t=this;e.chooseLocation({success:function(e){t.currentOrder.startaddress=e.name,t.currentOrder.startaddressall=e.address+e.name},fail:function(){e.getSetting({success:function(t){console.log(t);var n=t.authSetting;n["scope.userLocation"]||e.showModal({title:"是否授权当前位置",content:"需要获取您的地理位置，请确认授权，否则地图功能将无法使用",success:function(t){t.confirm&&e.openSetting({success:function(t){!0===t.authSetting["scope.userLocation"]?(e.showToast({title:"授权成功",icon:"success",duration:1e3}),e.chooseLocation({success:function(e){console.log("详细地址",e)}})):e.showToast({title:"授权失败",icon:"none",duration:1e3})}})}})},fail:function(t){e.showToast({title:"调用授权窗口失败",icon:"none",duration:1e3})}})}})},startConfirm:function(e){console.log("开始出发时间",this.$u.timeFormat(e.value,"yyyy-mm-dd hh:MM")),this.currentOrder.startdatetime=this.$u.timeFormat(e.value,"yyyy-mm-ddThh:MM:ss"),console.log("this.currentOrder.startdatetime",this.currentOrder.startdatetime)},choseStartDateTime:function(){this.$refs.startDatetimePicker.open()},lackConfirm:function(e){this.currentOrder.lackperson=e.value[0]},CurrentConfirm:function(e){this.currentOrder.currentperson=e.value[0]},choseCurrentPerson:function(){this.$refs.CurrentPicker.open()},choseLaskPerson:function(){this.$refs.lackPicker.open()},afterConfirm:function(e){console.log(e),this.currentOrder.aftertime=e.value},beforConfirm:function(e){console.log(e),this.currentOrder.beforetime=e.value},openBeforDatetimePicker:function(){1==this.currentOrder.isbefore&&this.$refs.beforDatetimePicker.open()},openAfterDatetimePicker:function(){1==this.currentOrder.isafter&&this.$refs.afterDatetimePicker.open()},tiqianChange:function(e){console.log("能否接受提前出发：",e),this.currentOrder.isbefore=1==e?1:0},yanhoChange:function(e){console.log("能否接受延后出发：",e),this.currentOrder.isafter=1==e?1:0}}};t.default=d}).call(this,n("543d")["default"])},9553:function(e,t,n){"use strict";(function(e,t){var r=n("4ea4");n("33e0");r(n("66fd"));var o=r(n("b85b"));e.__webpack_require_UNI_MP_PLUGIN__=n,t(o.default)}).call(this,n("bc2e")["default"],n("543d")["createPage"])},"9a50":function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return r}));var r={uvLoadingPage:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uv-loading-page/components/uv-loading-page/uv-loading-page")]).then(n.bind(null,"0309"))},uniCard:function(){return n.e("uni_modules/uni-card/components/uni-card/uni-card").then(n.bind(null,"922e"))},uLine:function(){return Promise.all([n.e("common/vendor"),n.e("node-modules/uview-ui/components/u-line/u-line")]).then(n.bind(null,"ac11"))},uvDatetimePicker:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uv-datetime-picker/components/uv-datetime-picker/uv-datetime-picker")]).then(n.bind(null,"b959"))},uvPicker:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uv-picker/components/uv-picker/uv-picker")]).then(n.bind(null,"2b51"))},uvUpload:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uv-upload/components/uv-upload/uv-upload")]).then(n.bind(null,"b80a"))},uvCheckboxGroup:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uv-checkbox/components/uv-checkbox-group/uv-checkbox-group")]).then(n.bind(null,"88f4"))},uvCheckbox:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uv-checkbox/components/uv-checkbox/uv-checkbox")]).then(n.bind(null,"1bd0"))},uniSection:function(){return n.e("uni_modules/uni-section/components/uni-section/uni-section").then(n.bind(null,"43d2"))},quickMessage:function(){return Promise.all([n.e("common/vendor"),n.e("components/quick-message/quick-message")]).then(n.bind(null,"bb33"))},zeroLoading:function(){return n.e("uni_modules/zero-loading/components/zero-loading/zero-loading").then(n.bind(null,"0cb3"))}},o=function(){var e=this.$createElement,t=(this._self._c,this.isPageLoding||""==this.currentOrder.startdatetime?null:this._f("fromStartDateTime")(this.currentOrder.startdatetime)),n=this.isPageLoding?null:this.currentOrder.remark.length;this.$mp.data=Object.assign({},{$root:{f0:t,g0:n}})},i=[]},b85b:function(e,t,n){"use strict";n.r(t);var r=n("9a50"),o=n("696d");for(var i in o)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(i);n("25a4");var s=n("f0c5"),c=Object(s["a"])(o["default"],r["b"],r["c"],!1,null,null,null,!1,r["a"],void 0);t["default"]=c.exports}},[["9553","common/runtime","common/vendor"]]]);