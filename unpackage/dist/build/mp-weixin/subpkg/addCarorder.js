(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["subpkg/addCarorder"],{"01b0":function(e,t,n){},3334:function(e,t,n){"use strict";n.r(t);var o=n("c7ef"),s=n("a723");for(var r in s)["default"].indexOf(r)<0&&function(e){n.d(t,e,(function(){return s[e]}))}(r);n("bb34");var i=n("f0c5"),c=Object(i["a"])(s["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],void 0);t["default"]=c.exports},5336:function(e,t,n){"use strict";(function(e,t){var o=n("4ea4");n("33e0");o(n("66fd"));var s=o(n("3334"));e.__webpack_require_UNI_MP_PLUGIN__=n,t(s.default)}).call(this,n("bc2e")["default"],n("543d")["createPage"])},a723:function(e,t,n){"use strict";n.r(t);var o=n("e84c"),s=n.n(o);for(var r in o)["default"].indexOf(r)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(r);t["default"]=s.a},bb34:function(e,t,n){"use strict";var o=n("01b0"),s=n.n(o);s.a},c7ef:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return o}));var o={uniCard:function(){return n.e("uni_modules/uni-card/components/uni-card/uni-card").then(n.bind(null,"922e"))},uLine:function(){return Promise.all([n.e("common/vendor"),n.e("node-modules/uview-ui/components/u-line/u-line")]).then(n.bind(null,"ac11"))},uvDatetimePicker:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uv-datetime-picker/components/uv-datetime-picker/uv-datetime-picker")]).then(n.bind(null,"b959"))},uvPicker:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uv-picker/components/uv-picker/uv-picker")]).then(n.bind(null,"2b51"))},uvUpload:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uv-upload/components/uv-upload/uv-upload")]).then(n.bind(null,"b80a"))},uvCheckboxGroup:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uv-checkbox/components/uv-checkbox-group/uv-checkbox-group")]).then(n.bind(null,"88f4"))},uvCheckbox:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uv-checkbox/components/uv-checkbox/uv-checkbox")]).then(n.bind(null,"1bd0"))},uniSection:function(){return n.e("uni_modules/uni-section/components/uni-section/uni-section").then(n.bind(null,"43d2"))},quickMessage:function(){return Promise.all([n.e("common/vendor"),n.e("components/quick-message/quick-message")]).then(n.bind(null,"bb33"))},zeroLoading:function(){return n.e("uni_modules/zero-loading/components/zero-loading/zero-loading").then(n.bind(null,"0cb3"))},wsWxPrivacy:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/ws-wx-privacy/components/ws-wx-privacy/ws-wx-privacy")]).then(n.bind(null,"cf5f"))}},s=function(){var e=this.$createElement,t=(this._self._c,this.ideaText.length);this.$mp.data=Object.assign({},{$root:{g0:t}})},r=[]},e84c:function(e,t,n){"use strict";(function(e){var o=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=o(n("2eee")),r=o(n("9523")),i=o(n("c973"));function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(){var e=new Date,t=e.getFullYear(),n=new Date(t,11,31,23,59,59,999);return n.getTime()}var l={data:function(){return{endDate:u(),resWximg:"",isUploadWximg:!1,fileList1:[],isLoading:!1,beforeTime:"00:00",isBefore:!1,afterTime:"00:00",isAfter:!1,ideaText:"",columns:[["1","2","3"]],currentPerson:"1",lackPerson:"1",startDateTime:"点击选择出发时间",StartTimeValue:Number(new Date),MinStartTimeValue:Number(new Date),startAddress:"点击选择出发地点1",startAddressAll:"",endAddress:"点击选择目的地1",endAddressAll:"",wechatAccount:"",phoneNumber:"",wechatError:!1,phoneError:!1,phoneErrorMessage:"手机号不能为空或格式不正确",wechatErrorMsg:"",afterAdd:!0}},computed:{isValid:function(){return""!==this.wechatAccount||this.isValidPhoneNumber},isTips:function(){return""==this.wechatAccount.trim()&&!this.isUploadWximg}},onLoad:function(){console.log(this.endDate)},watch:{phoneNumber:function(e,t){this.wechatError||e?/^1[3-9]\d{9}$/.test(e)?this.phoneError=!1:this.phoneError=!0:this.phoneError=!1},wechatAccount:function(e,t){if(""===this.phoneNumber.trim()){var n=/[\u4e00-\u9fa5]/i.test(e);n?(this.wechatError=!0,this.wechatErrorMsg="微信号不能包含中文字符"):(this.wechatError=!1,this.wechatErrorMsg="")}}},methods:{clickUploadImgM:function(){this.fileList1.length>=1||this.$refs.uploadWxImgRef.chooseFile()},uploadFilePromise:function(t){var n=this;return new Promise((function(o,s){e.uploadFile({url:n.http+"common/upload?path=QRcode",filePath:t,name:"file",formData:{user:"test"},timeout:5e3,success:function(e){console.log("上传成功",e.statusCode),n.isUploadWximg=!0;var t=JSON.parse(e.data).data;n.resWximg=t,o(200)},fail:function(e){console.log("上传失败",e),o(400)}})}))},overSize:function(){this.$refs.message.show({type:"error",msg:"图片超过3MB大小"})},afterRead:function(t){var n=this;return(0,i.default)(s.default.mark((function o(){var r,c,u,l;return s.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:for(r=[].concat(t.file),c=n["fileList".concat(t.name)].length,r.map((function(e){n["fileList".concat(t.name)].push(a(a({},e),{},{status:"uploading",message:"上传中"}))})),console.log(n.fileList1),u=function(o){console.log("还没有调用上传方法",r),e.compressImage({src:r[o].url,quality:70,success:function(){var e=(0,i.default)(s.default.mark((function e(i){var a,u;return s.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log(i.tempFilePath),console.log("压缩完成了"),r[o].url=i.tempFilePath,e.next=5,n.uploadFilePromise(r[o].url);case 5:a=e.sent,u=n["fileList".concat(t.name)][c],400==a?n["fileList".concat(t.name)].splice(c,1,Object.assign(u,{status:"failed",message:"请重传",url:a})):n["fileList".concat(t.name)].splice(c,1,Object.assign(u,{status:"success",message:"",url:a})),c++;case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()})},l=0;l<r.length;l++)u(l);case 6:case"end":return o.stop()}}),o)})))()},deletePic:function(e){this["fileList".concat(e.name)].splice(e.index,1),this.isUploadWximg=!1},postOrderData:function(){var t=this,n=e.getStorageSync("user");this.isLoading=!0,this.post({url:"carshareorder/add",data:{createuserid:n.openid,startaddressall:this.startAddressAll,startaddress:this.startAddress,endaddressall:this.endAddressAll,endaddress:this.endAddress,startdatetime:this.startDateTime.split(" ")[0]+"T"+this.startDateTime.split(" ")[1],currentperson:this.currentPerson,lackperson:this.lackPerson,phonenumber:this.phoneNumber,wechataccount:this.wechatAccount,isbefore:1==this.isBefore?1:0,beforetime:this.beforeTime,isafter:1==this.isAfter?1:0,aftertime:this.afterTime,remark:this.ideaText,wechatImg:this.resWximg}}).then((function(n){if(t.isLoading=!1,200!==n.code)return t.afterAdd=!0,void t.$refs.message.show({type:"error",msg:"发布拼车失败 请稍候重试吧"});t.$refs.message.show({type:"success",msg:"发布成功!"}),setTimeout((function(){e.$emit("addUpdate"),e.navigateBack()}),500)})).catch((function(e){t.afterAdd=!0,t.isLoading=!1,t.$refs.message.show({type:"error",msg:"网络开了点小差,请稍候重试吧"})}))},clickAddOrder:function(){var t=this,n=this.isWrite();console.log("isWriteResult",n),n&&this.afterAdd&&(this.afterAdd=!1,e.requestSubscribeMessage({tmplIds:["R0HVPNJRywpmvaA5xO6YWFfjLdGqcjWPB0-rqRkmkbk"],success:function(e){console.log("用户消息同意情况",e),t.postOrderData()},fail:function(e){console.log(e),t.$refs.message.show({type:"warning",msg:"同意请求才可以及时收到拼车消息哦"}),t.postOrderData()}}))},isWrite:function(){return 1==this.isAfter&&"00:00"==this.afterTime?(this.$refs.message.show({type:"warning",msg:"请选择能接受的延后时间范围",customStyle:{color:"#E6A23C",backgroundColor:"rgba(253,246,236)"}}),!1):1==this.isBefore&&"00:00"==this.beforeTime?(this.$refs.message.show({type:"warning",msg:"请选择能接受的提前时间范围",customStyle:{color:"#E6A23C",backgroundColor:"rgba(253,246,236)"}}),!1):""!=this.wechatAccount.trim()||this.isUploadWximg?"点击选择出发时间"==this.startDateTime?(this.$refs.message.show({type:"warning",msg:"请选择出发时间",customStyle:{color:"#E6A23C",backgroundColor:"rgba(253,246,236)"}}),!1):"点击选择目的地"==this.endAddress?(this.$refs.message.show({type:"warning",msg:"请选择目的地",customStyle:{color:"#E6A23C",backgroundColor:"rgba(253,246,236)"}}),!1):"点击选择出发地点"!=this.startAddress||(this.$refs.message.show({type:"warning",msg:"请选择出发地点",customStyle:{color:"#E6A23C",backgroundColor:"rgba(253,246,236)"},iconSize:16,iconColor:""}),!1):(this.$refs.message.show({type:"warning",msg:"请输入联系方式",customStyle:{color:"#E6A23C",backgroundColor:"rgba(253,246,236)"}}),!1)},formatter:function(e,t){return"year"===e?"".concat(t,"年"):"month"===e?"".concat(t,"月"):"day"===e?"".concat(t,"日"):"hour"===e?"".concat(t,"时"):"minute"===e?"".concat(t,"分"):t},choseEndAddress:function(){var t=this;e.chooseLocation({success:function(e){t.endAddress=e.name,t.endAddressAll=e.address+e.name},fail:function(){e.getSetting({success:function(t){console.log(t);var n=t.authSetting;n["scope.userLocation"]||e.showModal({title:"是否授权当前位置",content:"需要获取您的地理位置，请确认授权，否则地图功能将无法使用",success:function(t){t.confirm&&e.openSetting({success:function(t){!0===t.authSetting["scope.userLocation"]?(e.showToast({title:"授权成功",icon:"success",duration:1e3}),e.chooseLocation({success:function(e){console.log("详细地址",e)}})):e.showToast({title:"授权失败",icon:"none",duration:1e3})}})}})},fail:function(t){e.showToast({title:"调用授权窗口失败",icon:"none",duration:1e3})}})}})},choseStartAddress:function(){var t=this;e.chooseLocation({success:function(e){t.startAddress=e.name,t.startAddressAll=e.address+e.name},fail:function(){e.getSetting({success:function(t){console.log(t);var n=t.authSetting;n["scope.userLocation"]||e.showModal({title:"是否授权当前位置",content:"需要获取您的地理位置，请确认授权，否则地图功能将无法使用",success:function(t){t.confirm&&e.openSetting({success:function(t){!0===t.authSetting["scope.userLocation"]?(e.showToast({title:"授权成功",icon:"success",duration:1e3}),e.chooseLocation({success:function(e){console.log("详细地址",e)}})):e.showToast({title:"授权失败",icon:"none",duration:1e3})}})}})},fail:function(t){e.showToast({title:"调用授权窗口失败",icon:"none",duration:1e3})}})}})},startConfirm:function(e){console.log("开始出发时间",e),console.log("开始出发时间",this.$u.timeFormat(e.value,"yyyy-mm-dd hh:MM")),this.startDateTime=this.$u.timeFormat(e.value,"yyyy-mm-dd hh:MM")},choseStartDateTime:function(){this.$refs.startDatetimePicker.open()},lackConfirm:function(e){console.log("缺少人数",e.value[0]),this.lackPerson=e.value[0]},CurrentConfirm:function(e){console.log("当前人数",e.value[0]),this.currentPerson=e.value[0]},choseCurrentPerson:function(){this.$refs.CurrentPicker.open()},choseLaskPerson:function(){this.$refs.lackPicker.open()},afterConfirm:function(e){console.log(e),this.afterTime=e.value},beforConfirm:function(e){console.log(e),this.beforeTime=e.value},openBeforDatetimePicker:function(){this.isBefore&&this.$refs.beforDatetimePicker.open()},openAfterDatetimePicker:function(){this.isAfter&&this.$refs.afterDatetimePicker.open()},tiqianChange:function(e){console.log("能否接受提前出发：",e),this.isBefore=e},yanhoChange:function(e){console.log("能否接受延后出发：",e),this.isAfter=e}}};t.default=l}).call(this,n("543d")["default"])}},[["5336","common/runtime","common/vendor"]]]);